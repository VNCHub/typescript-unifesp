generator client {
  provider = "prisma-client"
  output   = "../src/client/prisma"
}


datasource db {
  provider = "sqlite"
}

model Usuario {
  id Int @id @default(autoincrement())
  nome String
  email String @unique
  senha String
  dataNascimento DateTime?
  tipo TipoUsuario @default(ALUNO)
  dataCadastro DateTime @default(now())

  aluno Aluno?

  @@map("usuarios")
}

model Aluno {
  id Int @id @default(autoincrement())
  usuarioId Int @unique
  dataMatricula DateTime @default(now())

  usuario Usuario @relation(fields: [usuarioId], references: [id])
  materias AlunoMateria[]

  @@map("alunos")
}

model Professor {
  id Int @id @default(autoincrement())
  nome String
  telefone String?
  especialidade String?
  materias Materia[]

  @@map("professores")
}

model Materia {
  id Int @id @default(autoincrement())
  nome String
  descricao String?
  professorId Int
  horario String?
  sala String?

  professor Professor @relation(fields: [professorId], references: [id])
  alunos AlunoMateria[]

  @@map("materias")
}

model AlunoMateria {
  id Int @id @default(autoincrement())
  alunoId Int
  materiaId Int
  nota Float?
  frequencia Float?
  notasAula NotaDeAula[]

  aluno Aluno @relation(fields: [alunoId], references: [id])
  materia Materia @relation(fields: [materiaId], references: [id])

  @@unique([alunoId, materiaId])
  @@map("alunos_materias")
}

model NotaDeAula {
  id Int @id @default(autoincrement())
  alunoMatriculaId Int
  titulo String
  data DateTime @default(now())
  markdown String

  alunoMateria AlunoMateria @relation(fields: [alunoMatriculaId], references: [id])

  @@map("notas_aula")
}

enum TipoUsuario {
  ALUNO
  ADMIN
}

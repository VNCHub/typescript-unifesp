// Configuração do banco
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

// Usuário (base: alunos e admin)
model Usuario {
  id Int @id @default(autoincrement())
  nome String
  email String @unique
  senha String
  data_nascimento DateTime?
  tipo TipoUsuario @default(ALUNO)
  data_cadastro DateTime @default(now())

  aluno Aluno?

  @@map("usuarios")
}

// Aluno
model Aluno {
  id Int @id @default(autoincrement())
  usuarioId Int @unique
  data_matricula DateTime @default(now())

  usuario Usuario @relation(fields: [usuarioId], references: [id])
  materias AlunoMateria[]

  @@map("alunos")
}

// Professor (sem usuário vinculado)
model Professor {
  id Int @id @default(autoincrement())
  nome String
  telefone String?
  especialidade String?
  materias Materia[]

  @@map("professores")
}

// Matéria
model Materia {
  id Int @id @default(autoincrement())
  nome String
  descricao String?
  professorId Int
  horario String?
  sala String?

  professor Professor @relation(fields: [professorId], references: [id])
  alunos AlunoMateria[]
  tarefas Tarefa[]

  @@map("materias")
}

// Relação Aluno x Matéria
model AlunoMateria {
  id Int @id @default(autoincrement())
  alunoId Int
  materiaId Int
  nota Float?
  frequencia Float?

  aluno Aluno @relation(fields: [alunoId], references: [id])
  materia Materia @relation(fields: [materiaId], references: [id])

  @@unique([alunoId, materiaId])
  @@map("alunos_materias")
}

// Tarefa
model Tarefa {
  id Int @id @default(autoincrement())
  materiaId Int
  titulo String
  descricao String?
  data_entrega DateTime?
  status String @default("Pendente")

  materia Materia @relation(fields: [materiaId], references: [id])

  @@map("tarefas")
}

// Enum tipo de usuário
enum TipoUsuario {
  ALUNO
  ADMIN
}

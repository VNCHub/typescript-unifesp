{
  "version": 3,
  "sources": ["../../src/frontend/HomeFrontend.ts"],
  "sourcesContent": ["declare const bootstrap: any;\n\ntype Professor = { id: number; nome: string };\ntype Subject = {\n  id?: number;\n  nome: string;\n  descricao?: string | null;\n  professorId: number;\n  professor?: Professor | null;\n  horario?: string | null;\n  sala?: string | null;\n};\n\nexport class HomeFrontend {\n  private API = \"/api/subjects\";\n\n  init() {\n    this.loadAndRender();\n    document.addEventListener(\"click\", (e) => {\n      const target = e.target as HTMLElement;\n      if (target?.dataset?.edit?.endsWith(\"-details\")) {\n        const id = Number(target.dataset.edit.replace(\"-details\", \"\"));\n        this.openDetailsModal(id);\n      }\n    });\n  }\n\n  private async openDetailsModal(id: number) {\n    const res = await fetch(`${this.API}/${id}`);\n    const subject = await res.json();\n\n    (this.$(\"#detail-nome\") as HTMLElement).textContent = subject.nome;\n    (this.$(\"#detail-descricao\") as HTMLElement).textContent = subject.descricao ?? \"\u2014\";\n    (this.$(\"#detail-professor\") as HTMLElement).textContent = subject.professor?.nome ?? \"\u2014\";\n    (this.$(\"#detail-horario\") as HTMLElement).textContent = subject.horario ?? \"\u2014\";\n    (this.$(\"#detail-sala\") as HTMLElement).textContent = subject.sala ?? \"\u2014\";\n\n    this.loadNotes(id);\n\n    const modal = new bootstrap.Modal(this.$(\"#subjectDetailsModal\")!);\n    modal.show();\n  }\n\n  private async loadNotes(subjectId: number) {\n    const list = this.$(\"#notes-list\")!;\n    list.innerHTML = `\n      <li class=\"list-group-item text-center text-muted\" id=\"notes-loading\">\n        <div class=\"spinner-border spinner-border-sm me-2\"></div>\n        Carregando notas...\n      </li>\n    `;\n\n    const res = await fetch(`/api/subjects/${subjectId}/notes`);\n    const notes = await res.json();\n\n    list.innerHTML = \"\";\n\n    if (!notes.length) {\n      list.innerHTML = `\n        <li class=\"list-group-item text-center text-muted\">\n          Nenhuma nota ainda.\n        </li>\n      `;\n      return;\n    }\n\n    for (const n of notes) {\n      const li = document.createElement(\"li\");\n      li.className = \"list-group-item d-flex justify-content-between align-items-center\";\n      li.innerHTML = `\n        <span>${this.escapeHtml(n.texto)}</span>\n        <div>\n          <button class=\"btn btn-sm btn-outline-secondary me-1\" data-edit-note=\"${n.id}\">Editar</button>\n          <button class=\"btn btn-sm btn-outline-danger\" data-delete-note=\"${n.id}\">Excluir</button>\n        </div>\n      `;\n      list.appendChild(li);\n    }\n  }\n\n\n\n  private $(sel: string): HTMLElement | null {\n    return document.querySelector(sel);\n  }\n\n  private escapeHtml(s = \"\") {\n    return String(s).replace(/[&<>\"']/g, (m) =>\n      ({ \"&\": \"&amp;\", \"<\": \"&lt;\", \">\": \"&gt;\", '\"': \"&quot;\", \"'\": \"&#39;\" } as any)[m]\n    );\n  }\n\n  private async fetchSubjects(): Promise<Subject[]> {\n    const res = await fetch(this.API);\n    if (!res.ok) throw new Error(\"Erro ao carregar mat\u00E9rias\");\n    return res.json();\n  }\n\n  private renderList(items: Subject[]) {\n    const container = this.$(\"#subject-list\")!;\n    container.innerHTML = \"\";\n\n    if (!items.length) {\n      container.innerHTML = `\n        <div class=\"col-12\">\n          <div class=\"alert alert-info\">Nenhuma mat\u00E9ria cadastrada ainda.</div>\n        </div>`;\n      return;\n    }\n\n    for (const s of items) {\n      const col = document.createElement(\"div\");\n      col.className = \"col-md-4 mb-3\";\n      col.innerHTML = `\n        <div class=\"card h-100\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">${this.escapeHtml(s.nome)}</h5>\n            <p class=\"card-text\">${this.escapeHtml(s.descricao || \"\")}</p>\n            <p class=\"small text-muted\">Professor: ${this.escapeHtml(s.professor?.nome ?? \"\u2014\")}</p>\n            <p class=\"text-muted small\">\n              ${this.escapeHtml(\n                s.horario\n                  ? s.horario + (s.sala ? \" \u2022 Sala \" + s.sala : \"\")\n                  : s.sala\n                  ? \"Sala \" + s.sala\n                  : \"\"\n              )}\n            </p>\n            <button class=\"btn btn-sm btn-outline-primary me-2\" data-edit=\"${s.id}-details\">Detalhes</button>\n          </div>\n        </div>`;\n      container.appendChild(col);\n    }\n  }\n\n  private async loadAndRender() {\n    try {\n      const subjects = await this.fetchSubjects();\n      this.renderList(subjects);\n    } catch (err) {\n      const container = this.$(\"#subject-list\")!;\n      container.innerHTML = `\n        <div class=\"col-12\">\n          <div class=\"alert alert-danger\">Erro ao carregar mat\u00E9rias.</div>\n        </div>`;\n    }\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
